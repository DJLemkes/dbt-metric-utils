{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.6", "generated_at": "2024-09-24T20:15:04.359698Z", "invocation_id": "13bb1d82-68b9-48b6-93cd-835e0d9e81f5", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.026385Z", "completed_at": "2024-09-24T20:15:04.044060Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.070060Z", "completed_at": "2024-09-24T20:15:04.070075Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06785988807678223, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_customers", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"jaffle_shop\".\"raw\".\"raw_customers\"\n\n),\n\nrenamed as (\n\n    select\n\n        ----------  ids\n        id as customer_id,\n\n        ---------- text\n        name as customer_name\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"jaffle_shop\".\"main\".\"stg_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.055383Z", "completed_at": "2024-09-24T20:15:04.056881Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.072501Z", "completed_at": "2024-09-24T20:15:04.072508Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.04786419868469238, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_customers", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.057449Z", "completed_at": "2024-09-24T20:15:04.058887Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.073915Z", "completed_at": "2024-09-24T20:15:04.073927Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.04877829551696777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_items", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.033315Z", "completed_at": "2024-09-24T20:15:04.059356Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.075236Z", "completed_at": "2024-09-24T20:15:04.075245Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07001852989196777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_locations", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"jaffle_shop\".\"raw\".\"raw_stores\"\n\n),\n\nrenamed as (\n\n    select\n\n        ----------  ids\n        id as location_id,\n\n        ---------- text\n        name as location_name,\n\n        ---------- numerics\n        tax_rate,\n\n        ---------- timestamps\n        date_trunc('day', opened_at) as opened_date\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"jaffle_shop\".\"main\".\"stg_locations\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.059822Z", "completed_at": "2024-09-24T20:15:04.061299Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.075954Z", "completed_at": "2024-09-24T20:15:04.075962Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.05024003982543945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_orders", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.061770Z", "completed_at": "2024-09-24T20:15:04.063382Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.076822Z", "completed_at": "2024-09-24T20:15:04.076829Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.047696828842163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_products", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.063847Z", "completed_at": "2024-09-24T20:15:04.065508Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.077611Z", "completed_at": "2024-09-24T20:15:04.077619Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.04807400703430176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_stores", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.066078Z", "completed_at": "2024-09-24T20:15:04.068872Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.079012Z", "completed_at": "2024-09-24T20:15:04.079021Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.04831743240356445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_supplies", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.038892Z", "completed_at": "2024-09-24T20:15:04.069495Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.079769Z", "completed_at": "2024-09-24T20:15:04.079777Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07098531723022461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_order_items", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"jaffle_shop\".\"raw\".\"raw_items\"\n\n),\n\nrenamed as (\n\n    select\n\n        ----------  ids\n        id as order_item_id,\n        order_id,\n        sku as product_id\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"jaffle_shop\".\"main\".\"stg_order_items\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.044568Z", "completed_at": "2024-09-24T20:15:04.071238Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.080683Z", "completed_at": "2024-09-24T20:15:04.080689Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.058209896087646484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_orders", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"jaffle_shop\".\"raw\".\"raw_orders\"\n\n),\n\nrenamed as (\n\n    select\n\n        ----------  ids\n        id as order_id,\n        store_id as location_id,\n        customer as customer_id,\n\n        ---------- numerics\n        subtotal as subtotal_cents,\n        tax_paid as tax_paid_cents,\n        order_total as order_total_cents,\n        (subtotal / 100)::numeric(16, 2) as subtotal,\n        (tax_paid / 100)::numeric(16, 2) as tax_paid,\n        (order_total / 100)::numeric(16, 2) as order_total,\n\n        ---------- timestamps\n        date_trunc('day', ordered_at) as ordered_at\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"jaffle_shop\".\"main\".\"stg_orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.048497Z", "completed_at": "2024-09-24T20:15:04.071963Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.082547Z", "completed_at": "2024-09-24T20:15:04.082555Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.05948901176452637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_products", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"jaffle_shop\".\"raw\".\"raw_products\"\n\n),\n\nrenamed as (\n\n    select\n\n        ----------  ids\n        sku as product_id,\n\n        ---------- text\n        name as product_name,\n        type as product_type,\n        description as product_description,\n\n\n        ---------- numerics\n        (price / 100)::numeric(16, 2) as product_price,\n\n        ---------- booleans\n        coalesce(type = 'jaffle', false) as is_food_item,\n\n        coalesce(type = 'beverage', false) as is_drink_item\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"jaffle_shop\".\"main\".\"stg_products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.051498Z", "completed_at": "2024-09-24T20:15:04.073314Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.083417Z", "completed_at": "2024-09-24T20:15:04.083423Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.059810638427734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_supplies", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"jaffle_shop\".\"raw\".\"raw_supplies\"\n\n),\n\nrenamed as (\n\n    select\n\n        ----------  ids\n        md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(sku as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as supply_uuid,\n        id as supply_id,\n        sku as product_id,\n\n        ---------- text\n        name as supply_name,\n\n        ---------- numerics\n        (cost / 100)::numeric(16, 2) as supply_cost,\n\n        ---------- booleans\n        perishable as is_perishable_supply\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"jaffle_shop\".\"main\".\"stg_supplies\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.115666Z", "completed_at": "2024-09-24T20:15:04.152867Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.198844Z", "completed_at": "2024-09-24T20:15:04.198853Z"}], "thread_id": "Thread-17 (worker)", "execution_time": 0.11016297340393066, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"jaffle_shop\".\"main\".\"stg_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.107710Z", "completed_at": "2024-09-24T20:15:04.153359Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.200590Z", "completed_at": "2024-09-24T20:15:04.200597Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.1130213737487793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"jaffle_shop\".\"main\".\"stg_customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.124064Z", "completed_at": "2024-09-24T20:15:04.176350Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.204529Z", "completed_at": "2024-09-24T20:15:04.204537Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.11266613006591797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.locations", "compiled": true, "compiled_code": "with\n\nlocations as (\n\n    select * from \"jaffle_shop\".\"main\".\"stg_locations\"\n\n)\n\nselect * from locations", "relation_name": "\"jaffle_shop\".\"main\".\"locations\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.127723Z", "completed_at": "2024-09-24T20:15:04.179540Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.205783Z", "completed_at": "2024-09-24T20:15:04.205790Z"}], "thread_id": "Thread-19 (worker)", "execution_time": 0.11234378814697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect location_id\nfrom \"jaffle_shop\".\"main\".\"stg_locations\"\nwhere location_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.132976Z", "completed_at": "2024-09-24T20:15:04.196644Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.207607Z", "completed_at": "2024-09-24T20:15:04.207613Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.11224222183227539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    location_id as unique_field,\n    count(*) as n_records\n\nfrom \"jaffle_shop\".\"main\".\"stg_locations\"\nwhere location_id is not null\ngroup by location_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.137523Z", "completed_at": "2024-09-24T20:15:04.198272Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.210949Z", "completed_at": "2024-09-24T20:15:04.210955Z"}], "thread_id": "Thread-21 (worker)", "execution_time": 0.11359810829162598, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"jaffle_shop\".\"main\".\"stg_orders\"\n\nwhere not(order_total - tax_paid = subtotal)\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.141855Z", "completed_at": "2024-09-24T20:15:04.199661Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.211833Z", "completed_at": "2024-09-24T20:15:04.211838Z"}], "thread_id": "Thread-22 (worker)", "execution_time": 0.11347389221191406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"jaffle_shop\".\"main\".\"stg_order_items\"\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.149133Z", "completed_at": "2024-09-24T20:15:04.200156Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.212563Z", "completed_at": "2024-09-24T20:15:04.212568Z"}], "thread_id": "Thread-23 (worker)", "execution_time": 0.11322832107543945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_item_id\nfrom \"jaffle_shop\".\"main\".\"stg_order_items\"\nwhere order_item_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.157598Z", "completed_at": "2024-09-24T20:15:04.201740Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.213392Z", "completed_at": "2024-09-24T20:15:04.213398Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.11286473274230957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select order_id as from_field\n    from \"jaffle_shop\".\"main\".\"stg_order_items\"\n    where order_id is not null\n),\n\nparent as (\n    select order_id as to_field\n    from \"jaffle_shop\".\"main\".\"stg_orders\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.153938Z", "completed_at": "2024-09-24T20:15:04.202254Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.214076Z", "completed_at": "2024-09-24T20:15:04.214081Z"}], "thread_id": "Thread-24 (worker)", "execution_time": 0.11413073539733887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"jaffle_shop\".\"main\".\"stg_orders\"\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.162276Z", "completed_at": "2024-09-24T20:15:04.202834Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.214789Z", "completed_at": "2024-09-24T20:15:04.214794Z"}], "thread_id": "Thread-25 (worker)", "execution_time": 0.11376714706420898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_item_id as unique_field,\n    count(*) as n_records\n\nfrom \"jaffle_shop\".\"main\".\"stg_order_items\"\nwhere order_item_id is not null\ngroup by order_item_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.166241Z", "completed_at": "2024-09-24T20:15:04.203338Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.215513Z", "completed_at": "2024-09-24T20:15:04.215519Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.11396384239196777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom \"jaffle_shop\".\"main\".\"stg_orders\"\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.169936Z", "completed_at": "2024-09-24T20:15:04.203982Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.216236Z", "completed_at": "2024-09-24T20:15:04.216243Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.11373496055603027, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.order_items", "compiled": true, "compiled_code": "with\n\norder_items as (\n\n    select * from \"jaffle_shop\".\"main\".\"stg_order_items\"\n\n),\n\n\norders as (\n\n    select * from \"jaffle_shop\".\"main\".\"stg_orders\"\n\n),\n\nproducts as (\n\n    select * from \"jaffle_shop\".\"main\".\"stg_products\"\n\n),\n\nsupplies as (\n\n    select * from \"jaffle_shop\".\"main\".\"stg_supplies\"\n\n),\n\norder_supplies_summary as (\n\n    select\n        product_id,\n\n        sum(supply_cost) as supply_cost\n\n    from supplies\n\n    group by 1\n\n),\n\njoined as (\n\n    select\n        order_items.*,\n\n        orders.ordered_at,\n\n        products.product_name,\n        products.product_price,\n        products.is_food_item,\n        products.is_drink_item,\n\n        order_supplies_summary.supply_cost\n\n    from order_items\n\n    left join orders on order_items.order_id = orders.order_id\n\n    left join products on order_items.product_id = products.product_id\n\n    left join order_supplies_summary\n        on order_items.product_id = order_supplies_summary.product_id\n\n)\n\nselect * from joined", "relation_name": "\"jaffle_shop\".\"main\".\"order_items\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.173317Z", "completed_at": "2024-09-24T20:15:04.205238Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.217052Z", "completed_at": "2024-09-24T20:15:04.217059Z"}], "thread_id": "Thread-18 (worker)", "execution_time": 0.11408209800720215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.products", "compiled": true, "compiled_code": "with\n\nproducts as (\n\n    select * from \"jaffle_shop\".\"main\".\"stg_products\"\n\n)\n\nselect * from products", "relation_name": "\"jaffle_shop\".\"main\".\"products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.176955Z", "completed_at": "2024-09-24T20:15:04.206522Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.218000Z", "completed_at": "2024-09-24T20:15:04.218005Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.11400771141052246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.supplies", "compiled": true, "compiled_code": "with\n\nsupplies as (\n\n    select * from \"jaffle_shop\".\"main\".\"stg_supplies\"\n\n)\n\nselect * from supplies", "relation_name": "\"jaffle_shop\".\"main\".\"supplies\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.193000Z", "completed_at": "2024-09-24T20:15:04.208459Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.218819Z", "completed_at": "2024-09-24T20:15:04.218825Z"}], "thread_id": "Thread-20 (worker)", "execution_time": 0.1124117374420166, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    supply_uuid as unique_field,\n    count(*) as n_records\n\nfrom \"jaffle_shop\".\"main\".\"stg_supplies\"\nwhere supply_uuid is not null\ngroup by supply_uuid\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.185419Z", "completed_at": "2024-09-24T20:15:04.208989Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.219542Z", "completed_at": "2024-09-24T20:15:04.219547Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.11458778381347656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect supply_uuid\nfrom \"jaffle_shop\".\"main\".\"stg_supplies\"\nwhere supply_uuid is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.180156Z", "completed_at": "2024-09-24T20:15:04.210003Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.220915Z", "completed_at": "2024-09-24T20:15:04.220921Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.11643099784851074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom \"jaffle_shop\".\"main\".\"stg_products\"\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.189341Z", "completed_at": "2024-09-24T20:15:04.210476Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.221632Z", "completed_at": "2024-09-24T20:15:04.221639Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.1157224178314209, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_products_product_id.7d950a1467", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom \"jaffle_shop\".\"main\".\"stg_products\"\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.009945Z", "completed_at": "2024-09-24T20:15:04.197563Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.209532Z", "completed_at": "2024-09-24T20:15:04.209537Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.22888708114624023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.metricflow_time_spine", "compiled": true, "compiled_code": "-- metricflow_time_spine.sql\nwith\n\ndays as (\n\n    --for BQ adapters use \"DATE('01/01/2000','mm/dd/yyyy')\"\n    \n    with date_spine as\n(\n\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n     + \n    \n    p11.generated_number * power(2, 11)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n     cross join \n    \n    p as p11\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 3651\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    date_add(\n\n    date_add(cast(cast(\n    cast(now() as timestamp)\n        at time zone 'UTC' at time zone 'America/Los_Angeles' as timestamp\n) as date), interval (-3650) day)\n\n, interval ((row_number() over (order by 1) - 1)) day)\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast(\n\n    date_add(cast(cast(\n    cast(now() as timestamp)\n        at time zone 'UTC' at time zone 'America/Los_Angeles' as timestamp\n) as date), interval (1) day)\n\n as date)\n\n)\n\nselect * from filtered\n\n\n\n)\nselect\n    cast(d.date_day as timestamp) as date_day\nfrom\n    date_spine d\n\n\n\n),\n\ncast_to_date as (\n\n    select cast(date_day as date) as date_day\n\n    from days\n\n)\n\nselect * from cast_to_date", "relation_name": "\"jaffle_shop\".\"main\".\"metricflow_time_spine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.232795Z", "completed_at": "2024-09-24T20:15:04.247513Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.249735Z", "completed_at": "2024-09-24T20:15:04.249744Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.023559093475341797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.orders", "compiled": true, "compiled_code": "with\n\norders as (\n\n    select * from \"jaffle_shop\".\"main\".\"stg_orders\"\n\n),\n\norder_items as (\n\n    select * from \"jaffle_shop\".\"main\".\"order_items\"\n\n),\n\norder_items_summary as (\n\n    select\n        order_id,\n\n        sum(supply_cost) as order_cost,\n        sum(product_price) as order_items_subtotal,\n        count(order_item_id) as count_order_items,\n        sum(\n            case\n                when is_food_item then 1\n                else 0\n            end\n        ) as count_food_items,\n        sum(\n            case\n                when is_drink_item then 1\n                else 0\n            end\n        ) as count_drink_items\n\n    from order_items\n\n    group by 1\n\n),\n\ncompute_booleans as (\n\n    select\n        orders.*,\n\n        order_items_summary.order_cost,\n        order_items_summary.order_items_subtotal,\n        order_items_summary.count_food_items,\n        order_items_summary.count_drink_items,\n        order_items_summary.count_order_items,\n        order_items_summary.count_food_items > 0 as is_food_order,\n        order_items_summary.count_drink_items > 0 as is_drink_order\n\n    from orders\n\n    left join\n        order_items_summary\n        on orders.order_id = order_items_summary.order_id\n\n),\n\ncustomer_order_count as (\n\n    select\n        *,\n\n        row_number() over (\n            partition by customer_id\n            order by ordered_at asc\n        ) as customer_order_number\n\n    from compute_booleans\n\n)\n\nselect * from customer_order_count", "relation_name": "\"jaffle_shop\".\"main\".\"orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.239232Z", "completed_at": "2024-09-24T20:15:04.248827Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.250652Z", "completed_at": "2024-09-24T20:15:04.250660Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.02346205711364746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_item_id\nfrom \"jaffle_shop\".\"main\".\"order_items\"\nwhere order_item_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.243194Z", "completed_at": "2024-09-24T20:15:04.249300Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.251873Z", "completed_at": "2024-09-24T20:15:04.251879Z"}], "thread_id": "Thread-20 (worker)", "execution_time": 0.02417898178100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_item_id as unique_field,\n    count(*) as n_records\n\nfrom \"jaffle_shop\".\"main\".\"order_items\"\nwhere order_item_id is not null\ngroup by order_item_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.236247Z", "completed_at": "2024-09-24T20:15:04.251402Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.252996Z", "completed_at": "2024-09-24T20:15:04.253001Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.02629232406616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.revenue_metrics", "compiled": true, "compiled_code": "SELECT * FROM (SELECT\n  metric_time__day\n  , SUM(revenue) AS revenue\n  , SUM(food_revenue) AS food_revenue\n  , SUM(drink_revenue) AS drink_revenue\nFROM (\n  SELECT\n    DATE_TRUNC('day', ordered_at) AS metric_time__day\n    , product_price AS revenue\n    , case when is_food_item is true then product_price else 0 end AS food_revenue\n    , case when is_drink_item is true then product_price else 0 end AS drink_revenue\n  FROM \"jaffle_shop\".\"main\".\"order_items\" order_item_src_10000\n) subq_2\nGROUP BY\n  metric_time__day)", "relation_name": "\"jaffle_shop\".\"main\".\"revenue_metrics\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.265655Z", "completed_at": "2024-09-24T20:15:04.299364Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.303973Z", "completed_at": "2024-09-24T20:15:04.303982Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.046802520751953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.customers", "compiled": true, "compiled_code": "with\n\ncustomers as (\n\n    select * from \"jaffle_shop\".\"main\".\"stg_customers\"\n\n),\n\norders as (\n\n    select * from \"jaffle_shop\".\"main\".\"orders\"\n\n),\n\ncustomer_orders_summary as (\n\n    select\n        orders.customer_id,\n\n        count(distinct orders.order_id) as count_lifetime_orders,\n        count(distinct orders.order_id) > 1 as is_repeat_buyer,\n        min(orders.ordered_at) as first_ordered_at,\n        max(orders.ordered_at) as last_ordered_at,\n        sum(orders.subtotal) as lifetime_spend_pretax,\n        sum(orders.tax_paid) as lifetime_tax_paid,\n        sum(orders.order_total) as lifetime_spend\n\n    from orders\n\n    group by 1\n\n),\n\njoined as (\n\n    select\n        customers.*,\n\n        customer_orders_summary.count_lifetime_orders,\n        customer_orders_summary.first_ordered_at,\n        customer_orders_summary.last_ordered_at,\n        customer_orders_summary.lifetime_spend_pretax,\n        customer_orders_summary.lifetime_tax_paid,\n        customer_orders_summary.lifetime_spend,\n\n        case\n            when customer_orders_summary.is_repeat_buyer then 'returning'\n            else 'new'\n        end as customer_type\n\n    from customers\n\n    left join customer_orders_summary\n        on customers.customer_id = customer_orders_summary.customer_id\n\n)\n\nselect * from joined", "relation_name": "\"jaffle_shop\".\"main\".\"customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.282829Z", "completed_at": "2024-09-24T20:15:04.301039Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.305717Z", "completed_at": "2024-09-24T20:15:04.305724Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.04588580131530762, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_orders_order_id.cf6c17daed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"jaffle_shop\".\"main\".\"orders\"\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.274861Z", "completed_at": "2024-09-24T20:15:04.301758Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.306462Z", "completed_at": "2024-09-24T20:15:04.306467Z"}], "thread_id": "Thread-20 (worker)", "execution_time": 0.047774553298950195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"jaffle_shop\".\"main\".\"orders\"\n\nwhere not(order_items_subtotal = subtotal)\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.278875Z", "completed_at": "2024-09-24T20:15:04.302438Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.307166Z", "completed_at": "2024-09-24T20:15:04.307173Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.04782438278198242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"jaffle_shop\".\"main\".\"orders\"\n\nwhere not(order_total = subtotal + tax_paid)\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.286556Z", "completed_at": "2024-09-24T20:15:04.302926Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.307891Z", "completed_at": "2024-09-24T20:15:04.307896Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.04755282402038574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select order_id as from_field\n    from \"jaffle_shop\".\"main\".\"order_items\"\n    where order_id is not null\n),\n\nparent as (\n    select order_id as to_field\n    from \"jaffle_shop\".\"main\".\"orders\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.290881Z", "completed_at": "2024-09-24T20:15:04.303420Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.308617Z", "completed_at": "2024-09-24T20:15:04.308623Z"}], "thread_id": "Thread-19 (worker)", "execution_time": 0.04775691032409668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"jaffle_shop\".\"main\".\"orders\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"jaffle_shop\".\"main\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.295633Z", "completed_at": "2024-09-24T20:15:04.304780Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.309509Z", "completed_at": "2024-09-24T20:15:04.309514Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.04762125015258789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_orders_order_id.fed79b3a6e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom \"jaffle_shop\".\"main\".\"orders\"\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.271645Z", "completed_at": "2024-09-24T20:15:04.313013Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.316513Z", "completed_at": "2024-09-24T20:15:04.316518Z"}], "thread_id": "Thread-17 (worker)", "execution_time": 0.05832099914550781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.order_metrics", "compiled": true, "compiled_code": "SELECT * FROM (SELECT\n  COALESCE(subq_4.metric_time__day, subq_11.metric_time__day, subq_18.metric_time__day, subq_25.metric_time__day) AS metric_time__day\n  , MAX(subq_4.orders) AS orders\n  , MAX(subq_4.order_total) AS order_total\n  , MAX(subq_11.new_customer_orders) AS new_customer_orders\n  , MAX(subq_18.food_orders) AS food_orders\n  , MAX(subq_25.drink_orders) AS drink_orders\nFROM (\n  SELECT\n    metric_time__day\n    , SUM(order_count) AS orders\n    , SUM(order_total) AS order_total\n  FROM (\n    SELECT\n      DATE_TRUNC('day', ordered_at) AS metric_time__day\n      , order_total\n      , 1 AS order_count\n    FROM \"jaffle_shop\".\"main\".\"orders\" orders_src_10000\n  ) subq_2\n  GROUP BY\n    metric_time__day\n) subq_4\nFULL OUTER JOIN (\n  SELECT\n    metric_time__day\n    , SUM(order_count) AS new_customer_orders\n  FROM (\n    SELECT\n      DATE_TRUNC('day', ordered_at) AS metric_time__day\n      , customer_order_number AS order_id__customer_order_number\n      , 1 AS order_count\n    FROM \"jaffle_shop\".\"main\".\"orders\" orders_src_10000\n  ) subq_7\n  WHERE order_id__customer_order_number = 1\n  GROUP BY\n    metric_time__day\n) subq_11\nON\n  subq_4.metric_time__day = subq_11.metric_time__day\nFULL OUTER JOIN (\n  SELECT\n    metric_time__day\n    , SUM(order_count) AS food_orders\n  FROM (\n    SELECT\n      DATE_TRUNC('day', ordered_at) AS metric_time__day\n      , is_food_order AS order_id__is_food_order\n      , 1 AS order_count\n    FROM \"jaffle_shop\".\"main\".\"orders\" orders_src_10000\n  ) subq_14\n  WHERE order_id__is_food_order = true\n  GROUP BY\n    metric_time__day\n) subq_18\nON\n  COALESCE(subq_4.metric_time__day, subq_11.metric_time__day) = subq_18.metric_time__day\nFULL OUTER JOIN (\n  SELECT\n    metric_time__day\n    , SUM(order_count) AS drink_orders\n  FROM (\n    SELECT\n      DATE_TRUNC('day', ordered_at) AS metric_time__day\n      , is_drink_order AS order_id__is_drink_order\n      , 1 AS order_count\n    FROM \"jaffle_shop\".\"main\".\"orders\" orders_src_10000\n  ) subq_21\n  WHERE order_id__is_drink_order = true\n  GROUP BY\n    metric_time__day\n) subq_25\nON\n  COALESCE(subq_4.metric_time__day, subq_11.metric_time__day, subq_18.metric_time__day) = subq_25.metric_time__day\nGROUP BY\n  COALESCE(subq_4.metric_time__day, subq_11.metric_time__day, subq_18.metric_time__day, subq_25.metric_time__day))", "relation_name": "\"jaffle_shop\".\"main\".\"order_metrics\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.328576Z", "completed_at": "2024-09-24T20:15:04.341184Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.343353Z", "completed_at": "2024-09-24T20:15:04.343362Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.028439998626708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"jaffle_shop\".\"main\".\"customers\"\n\nwhere not(lifetime_spend_pretax + lifetime_tax_paid = lifetime_spend)\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.322738Z", "completed_at": "2024-09-24T20:15:04.341710Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.344619Z", "completed_at": "2024-09-24T20:15:04.344624Z"}], "thread_id": "Thread-23 (worker)", "execution_time": 0.030171871185302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_type as value_field,\n        count(*) as n_records\n\n    from \"jaffle_shop\".\"main\".\"customers\"\n    group by customer_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'new','returning'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.332522Z", "completed_at": "2024-09-24T20:15:04.342816Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.345456Z", "completed_at": "2024-09-24T20:15:04.345461Z"}], "thread_id": "Thread-24 (worker)", "execution_time": 0.029996156692504883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"jaffle_shop\".\"main\".\"customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.336426Z", "completed_at": "2024-09-24T20:15:04.344155Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.346825Z", "completed_at": "2024-09-24T20:15:04.346832Z"}], "thread_id": "Thread-25 (worker)", "execution_time": 0.03090047836303711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"jaffle_shop\".\"main\".\"customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-24T20:15:04.319630Z", "completed_at": "2024-09-24T20:15:04.346208Z"}, {"name": "execute", "started_at": "2024-09-24T20:15:04.347817Z", "completed_at": "2024-09-24T20:15:04.347823Z"}], "thread_id": "Thread-22 (worker)", "execution_time": 0.033899545669555664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.customer_orders", "compiled": true, "compiled_code": "SELECT * FROM (SELECT\n  COALESCE(subq_4.customer, subq_10.customer) AS customer\n  , MAX(subq_4.count_lifetime_orders) AS count_lifetime_orders\n  , MAX(subq_4.lifetime_spend_pretax) AS lifetime_spend_pretax\n  , MAX(subq_10.average_order_value) AS average_order_value\nFROM (\n  SELECT\n    customer_id AS customer\n    , SUM(count_lifetime_orders) AS count_lifetime_orders\n    , SUM(lifetime_spend_pretax) AS lifetime_spend_pretax\n  FROM \"jaffle_shop\".\"main\".\"customers\" customers_src_10000\n  GROUP BY\n    customer_id\n) subq_4\nFULL OUTER JOIN (\n  SELECT\n    customer\n    , lifetime_spend_pretax / count_lifetime_orders AS average_order_value\n  FROM (\n    SELECT\n      customer_id AS customer\n      , SUM(count_lifetime_orders) AS count_lifetime_orders\n      , SUM(lifetime_spend_pretax) AS lifetime_spend_pretax\n    FROM \"jaffle_shop\".\"main\".\"customers\" customers_src_10000\n    GROUP BY\n      customer_id\n  ) subq_9\n) subq_10\nON\n  subq_4.customer = subq_10.customer\nGROUP BY\n  COALESCE(subq_4.customer, subq_10.customer))", "relation_name": "\"jaffle_shop\".\"main\".\"customer_orders\""}], "elapsed_time": 0.45342326164245605, "args": {"write_json": true, "which": "generate", "version_check": true, "introspect": true, "static_parser": true, "print": true, "warn_error_options": {"include": [], "exclude": []}, "quiet": false, "log_level": "info", "log_format_file": "debug", "exclude": [], "use_colors": true, "send_anonymous_usage_stats": true, "static": true, "log_file_max_bytes": 10485760, "log_level_file": "debug", "partial_parse": true, "require_resource_names_without_spaces": false, "source_freshness_run_project_hooks": false, "defer": false, "show_resource_report": false, "vars": {"metrics=['count_lifetime_orders', 'lifetime_spend_pretax', 'average_order_value'],dimensions=,group_by=['customer'],limit=,time_start=,time_end=,where=,order_by=": "SELECT\n  COALESCE(subq_4.customer, subq_10.customer) AS customer\n  , MAX(subq_4.count_lifetime_orders) AS count_lifetime_orders\n  , MAX(subq_4.lifetime_spend_pretax) AS lifetime_spend_pretax\n  , MAX(subq_10.average_order_value) AS average_order_value\nFROM (\n  SELECT\n    customer_id AS customer\n    , SUM(count_lifetime_orders) AS count_lifetime_orders\n    , SUM(lifetime_spend_pretax) AS lifetime_spend_pretax\n  FROM \"jaffle_shop\".\"main\".\"customers\" customers_src_10000\n  GROUP BY\n    customer_id\n) subq_4\nFULL OUTER JOIN (\n  SELECT\n    customer\n    , lifetime_spend_pretax / count_lifetime_orders AS average_order_value\n  FROM (\n    SELECT\n      customer_id AS customer\n      , SUM(count_lifetime_orders) AS count_lifetime_orders\n      , SUM(lifetime_spend_pretax) AS lifetime_spend_pretax\n    FROM \"jaffle_shop\".\"main\".\"customers\" customers_src_10000\n    GROUP BY\n      customer_id\n  ) subq_9\n) subq_10\nON\n  subq_4.customer = subq_10.customer\nGROUP BY\n  COALESCE(subq_4.customer, subq_10.customer)", "metrics=['orders', 'new_customer_orders', 'order_total', 'food_orders', 'drink_orders'],dimensions=,group_by=['metric_time__day'],limit=,time_start=,time_end=,where=,order_by=": "SELECT\n  COALESCE(subq_4.metric_time__day, subq_11.metric_time__day, subq_18.metric_time__day, subq_25.metric_time__day) AS metric_time__day\n  , MAX(subq_4.orders) AS orders\n  , MAX(subq_4.order_total) AS order_total\n  , MAX(subq_11.new_customer_orders) AS new_customer_orders\n  , MAX(subq_18.food_orders) AS food_orders\n  , MAX(subq_25.drink_orders) AS drink_orders\nFROM (\n  SELECT\n    metric_time__day\n    , SUM(order_count) AS orders\n    , SUM(order_total) AS order_total\n  FROM (\n    SELECT\n      DATE_TRUNC('day', ordered_at) AS metric_time__day\n      , order_total\n      , 1 AS order_count\n    FROM \"jaffle_shop\".\"main\".\"orders\" orders_src_10000\n  ) subq_2\n  GROUP BY\n    metric_time__day\n) subq_4\nFULL OUTER JOIN (\n  SELECT\n    metric_time__day\n    , SUM(order_count) AS new_customer_orders\n  FROM (\n    SELECT\n      DATE_TRUNC('day', ordered_at) AS metric_time__day\n      , customer_order_number AS order_id__customer_order_number\n      , 1 AS order_count\n    FROM \"jaffle_shop\".\"main\".\"orders\" orders_src_10000\n  ) subq_7\n  WHERE order_id__customer_order_number = 1\n  GROUP BY\n    metric_time__day\n) subq_11\nON\n  subq_4.metric_time__day = subq_11.metric_time__day\nFULL OUTER JOIN (\n  SELECT\n    metric_time__day\n    , SUM(order_count) AS food_orders\n  FROM (\n    SELECT\n      DATE_TRUNC('day', ordered_at) AS metric_time__day\n      , is_food_order AS order_id__is_food_order\n      , 1 AS order_count\n    FROM \"jaffle_shop\".\"main\".\"orders\" orders_src_10000\n  ) subq_14\n  WHERE order_id__is_food_order = true\n  GROUP BY\n    metric_time__day\n) subq_18\nON\n  COALESCE(subq_4.metric_time__day, subq_11.metric_time__day) = subq_18.metric_time__day\nFULL OUTER JOIN (\n  SELECT\n    metric_time__day\n    , SUM(order_count) AS drink_orders\n  FROM (\n    SELECT\n      DATE_TRUNC('day', ordered_at) AS metric_time__day\n      , is_drink_order AS order_id__is_drink_order\n      , 1 AS order_count\n    FROM \"jaffle_shop\".\"main\".\"orders\" orders_src_10000\n  ) subq_21\n  WHERE order_id__is_drink_order = true\n  GROUP BY\n    metric_time__day\n) subq_25\nON\n  COALESCE(subq_4.metric_time__day, subq_11.metric_time__day, subq_18.metric_time__day) = subq_25.metric_time__day\nGROUP BY\n  COALESCE(subq_4.metric_time__day, subq_11.metric_time__day, subq_18.metric_time__day, subq_25.metric_time__day)", "metrics=['revenue', 'food_revenue', 'drink_revenue'],dimensions=,group_by=['metric_time__day'],limit=,time_start=,time_end=,where=,order_by=": "SELECT\n  metric_time__day\n  , SUM(revenue) AS revenue\n  , SUM(food_revenue) AS food_revenue\n  , SUM(drink_revenue) AS drink_revenue\nFROM (\n  SELECT\n    DATE_TRUNC('day', ordered_at) AS metric_time__day\n    , product_price AS revenue\n    , case when is_food_item is true then product_price else 0 end AS food_revenue\n    , case when is_drink_item is true then product_price else 0 end AS drink_revenue\n  FROM \"jaffle_shop\".\"main\".\"order_items\" order_item_src_10000\n) subq_2\nGROUP BY\n  metric_time__day"}, "require_explicit_package_overrides_for_builtin_materializations": true, "log_path": "/home/runner/work/dbt-metric-utils/dbt-metric-utils/jaffle-shop/logs", "project_dir": "/home/runner/work/dbt-metric-utils/dbt-metric-utils/jaffle-shop", "macro_debugging": false, "enable_legacy_logger": false, "partial_parse_file_diff": true, "printer_width": 80, "use_colors_file": true, "strict_mode": false, "log_format": "default", "favor_state": false, "indirect_selection": "eager", "populate_cache": true, "compile": true, "profiles_dir": "/home/runner/work/dbt-metric-utils/dbt-metric-utils/jaffle-shop", "select": [], "cache_selected_only": false, "empty_catalog": false, "invocation_command": "dbt docs generate --static"}}